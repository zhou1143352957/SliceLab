# 10 页面样式与布局

## 适用范围

- uni-app 页面样式设计、跨端布局兼容、样式问题排查时使用。

## 规则

- 先确认页面渲染类型：`vue` 页面走 webview，`nvue/uvue` 页面走原生渲染，CSS 能力边界不同。
- 预处理器统一支持 `less/sass/scss/stylus`；Vue3 项目默认 `dart-sass`，样式深度选择器优先 `::v-deep`。
- 通用单位优先 `px/rpx`；`rem/vh/vw` 仅在 `vue` 页面使用，`nvue` 不使用百分比布局。
- nvue 仅支持 `flex` 布局且默认纵向（`column`）；布局主轴策略需显式定义，避免沿用 web 默认流式假设。
- 需要稳定跨端布局时优先 `Flex`，减少依赖端特性。
- 宽屏适配优先“局部拉伸”：固定区域使用 `px`，可伸缩区域使用 `flex`；避免全页面等比放大。
- `rpx` 仅作为等比缩放策略，在 PC/Pad 宽屏需结合 `pages.json > globalStyle` 的 `rpxCalcMaxDeviceWidth/rpxCalcBaseDeviceWidth/rpxCalcIncludeWidth` 控制放大范围。
- 禁止把 `750rpx` 当 `100%` 长期使用；确需兼容历史写法时优先改为 `flex`，或通过 `rpxCalcIncludeWidth` 做最小范围兜底。
- 屏幕适配优先运行时动态适配（如媒体查询、`match-media`、响应式布局组件），不把“PC版单独条件编译”作为默认方案。
- 使用 `uni-row` 栅格时按断点设计：`<768`、`>=768`、`>=992`、`>=1200`、`>=1920` 对应 `xs/sm/md/lg/xl`。
- 选择器避免使用 `*`；微信小程序自定义组件场景优先 `class` 选择器。
- nvue 样式优先 `class` 选择器，不依赖复杂后代选择器与标签选择器。
- nvue 文本必须放在 `<text>` 内，字体大小和颜色等文本样式仅对 `<text>` 节点生效。
- nvue 不支持 CSS 背景图，背景图需求通过 `<image>` + 层叠布局实现。
- nvue 页面逻辑条件渲染优先 `v-if`，不依赖 `v-show` 行为等效替代。
- nvue `@import` 仅用于本地样式文件，不使用网络 URL（如 `http/https`）。
- `App.vue` 公共样式会参与 nvue 样式编译；若不希望参与，使用 `APP-PLUS-NVUE` 条件样式隔离。
- 全局样式放 `App.vue`；`nvue` 页面不依赖全局样式能力。
- 背景图与字体资源遵循端约束：小程序 CSS 不直接使用本地文件路径，优先网络地址或 base64。
- 字体图标网络地址必须使用 `https`；端特有字体方案放适配层，不在页面散落实现。

## 示例

- `vue` 页面使用 `rpx + flex` 完成自适应布局，`nvue` 页面使用原生可支持样式实现同布局。
- 样式深度穿透写法统一为 `::v-deep .child { ... }`。
- 小程序端背景资源改为网络地址或脚本导入绑定，不直接写本地相对路径。
- 列表项采用“左侧图标固定宽高 + 右侧文本 `flex:1`”实现局部拉伸，宽屏变化时仅文本区伸缩。
- `pages.json` 宽屏参数示例：`rpxCalcMaxDeviceWidth: 960`、`rpxCalcBaseDeviceWidth: 375`、`rpxCalcIncludeWidth: 750`。
- 使用 `uni-row/uni-col` 按 `xs/sm/md/lg/xl` 断点配置列宽，避免手写大量媒体查询。
- nvue 背景图示例：容器内先渲染 `<image class="bg">`，再叠加内容层实现视觉背景。

## 反例

- 把 `nvue` 页面当成普通 web CSS 环境，使用百分比布局导致渲染异常。
- 在小程序 CSS 中直接使用本地字体或本地背景图路径，真机样式丢失。
- 在需要 scoped 穿透时继续使用旧写法 `/deep/` 导致样式失效。
- 使用 `*` 通配选择器做全局重置，跨端出现不可控副作用。
- 全页面依赖 `rpx` 等比缩放，宽屏下界面被整体放大失真。
- 把 `750rpx` 当作“永远等于 100% 宽度”，导致 `rpx` 上限生效后布局不再铺满。
- 为了宽屏适配直接做整套 PC 条件编译页面，导致 iPad 横竖屏切换体验割裂。
- 在 nvue 使用 `v-show` 处理核心显隐，导致行为与预期不一致。
- 在 nvue 用 `view` 直接承载文本并设置字体样式，结果样式不生效。
- 在 nvue 直接写 `background-image`、百分比布局或媒体查询，导致布局与样式异常。
- 在 nvue 里 `@import` 在线样式地址，导致样式加载失败。
- 在 `App.vue` 直接写通用 web 样式影响 nvue，导致端上样式告警或异常。

## 检查项

- 页面样式问题是否先区分 `vue/nvue/uvue` 渲染机制。
- 单位使用是否符合端约束（`rem/vh/vw` 与百分比限制）。
- 适配策略是否优先局部拉伸，并明确哪些区域允许等比缩放。
- `rpxCalcMaxDeviceWidth/rpxCalcBaseDeviceWidth/rpxCalcIncludeWidth` 是否按业务预期配置并回归。
- 代码中是否仍把 `750rpx` 当作通用百分比宽度。
- 选择器、深度穿透写法是否符合当前 Vue3 规范。
- nvue 是否遵循 `flex` 单一布局模型且主轴方向明确。
- nvue 文本节点是否统一使用 `<text>` 并验证字体样式生效。
- nvue 是否规避 `background-image`、`v-show`、百分比与媒体查询等受限能力。
- nvue 是否只 `@import` 本地样式，并处理 `App.vue` 样式对 nvue 的影响边界。
- 字体和背景资源路径在目标端是否可用且可回归。
- 栅格断点（`xs/sm/md/lg/xl`）在常见宽度档位是否表现一致。
- 关键页面是否通过 H5、小程序、App 样式冒烟验证。

## 来源

- 官方教程（2026-02-11 查阅）：https://uniapp.dcloud.net.cn/tutorial/syntax-css.html
- 官方教程（2026-02-11 查阅）：https://uniapp.dcloud.net.cn/tutorial/adapt.html
- 官方教程（2026-02-11 查阅）：https://uniapp.dcloud.net.cn/tutorial/nvue-outline.html
- 官方教程（2026-02-11 查阅）：https://uniapp.dcloud.net.cn/tutorial/nvue-css.html

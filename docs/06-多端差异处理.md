# 06 多端差异处理

## 适用范围

- 同功能需兼容 H5、App、小程序等多端时使用。

## 规则

- 多端实现优先采用“统一 `uni.*` API + 条件编译”组合。
- 平台差异统一收敛在适配层，不把分支散落到页面。
- 使用条件编译控制端能力：`#ifdef` / `#ifndef`。
- 对不可用能力提供降级方案与用户提示。
- 端特定逻辑写注释说明原因与影响范围。
- 涉及 `app-nvue` 页面时，布局优先 `flex`，减少跨端样式偏差。

## 示例

- 分享、定位、支付等能力走 `platform adapter` 封装。
- H5 不支持能力时给出可替代路径。
- 小程序差异逻辑集中在适配层 `#ifdef MP-WEIXIN` 代码块中。

## 反例

- 同一页面存在大量端判断，导致主流程不可读。
- 直接调用端 API，不判断权限和可用性。
- `nvue` 页面复用大量 web 布局写法，导致渲染不一致。

## 检查项

- 端差异是否集中管理。
- 条件编译块是否最小化且可读。
- 降级路径是否可验证、可回退。
- 页面主流程中是否存在大量平台分支判断。

## 来源

- 官方教程（2026-02-11 查阅）：https://uniapp.dcloud.net.cn/tutorial/

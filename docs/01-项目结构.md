# 01 项目结构

## 适用范围

- 新建业务模块、重构目录、统一命名时使用。

## 规则

- 页面与组件统一使用 `.vue` 单文件组件组织。
- JS 引擎版页面文件后缀使用 `.vue` / `.nvue`；默认优先维护 `.vue` 页面。
- 页面放 `src/pages/<module>/<page>.vue`，避免扁平堆叠。
- 复用组件放 `src/components/<domain>/`，禁止页面内堆大组件。
- 接口按域拆分到 `src/api/<domain>.ts`。
- 工具方法按职责拆到 `src/utils/`，不放页面脚本里。
- 样式变量统一放 `src/uni.scss` 或独立 tokens 文件。
- 新项目默认使用 `Vue3 + Vite + TypeScript`，除非旧项目有明确约束。
- TypeScript 版本保持 `>= 4.9`，并在项目根安装 `typescript` 与 `@dcloudio/types`。
- `tsconfig.json` 必须包含 `types: ["@dcloudio/types"]`，保证 `uni` 全局类型可识别。
- `tsconfig.json` 建议开启 `resolveJsonModule`，并排除 `node_modules`、`unpackage` 等非业务源码目录。
- 保持核心目录职责清晰：`pages` 页面、`components` 组件、`static` 静态资源、`uni_modules` 插件模块。
- `unpackage` 仅作为编译产物目录，禁止放业务源码与长期维护文件。
- 页面 `script` 支持 `lang="ts"`；页面主逻辑写在 `export default` 内，外层只保留导入、类型和轻量常量。
- 使用 `lang="ts"` 的页面在 Vue2 兼容链路下，引用组件优先保持 TS 一致，避免类型与编译链路冲突。
- 代码导入路径统一使用 `@/`（项目根）或编译期相对路径，避免深层 `../../` 可读性问题。
- 页面引用组件和组件内部引用组件使用同一导入路径规范，避免多套风格并存。
- `js` 文件引入可用 `@/` 和相对路径；禁止使用 `/` 开头引入 `js` 模块。
- `json` 文件可在 `js/ts/uts` 与页面 `script` 中直接 `import`，路径使用相对路径或 `@/`。
- `@` 别名在 `uni-app` 指向项目根目录；CLI 结构中通常映射到 `src`。

## 示例

- 用户模块：`src/pages/user/profile.vue`
- 用户接口：`src/api/user.ts`
- 用户复用卡片：`src/components/user/UserCard.vue`
- 入口采用 `src/main.ts` + `vite.config.ts` 组合。
- 工程配置分工：`App.vue` 管全局样式与应用生命周期，`pages.json` 管页面路由，`manifest.json` 管应用打包信息。
- `Vue3` 页面 `template` 可使用多根节点，减少无意义包裹层级。
- `tsconfig` 关键配置示例：`"types": ["@dcloudio/types"]`、`"resolveJsonModule": true`。
- 页面脚本示例：`<script lang="ts" setup>...</script>`。
- 组件导入示例：`import UserCard from '@/components/user/UserCard.vue'`。
- 页面与子组件都采用 `@/components/...` 统一路径风格。
- 公共脚本导入示例：`import add from '@/common/add.js'`。
- `json` 导入示例：`import config from '@/config/app.json'`。

## 反例

- 把所有页面都放在 `src/pages/` 根目录。
- 在单个 `.vue` 中同时写接口、工具函数、复杂样式。
- 在 `Vue3` 项目中引入历史脚手架目录习惯，导致构建链路混杂。
- 把长期维护的配置或脚本放进 `unpackage`，导致清理产物时丢失。
- 把大量同步耗时逻辑放在 `export default` 外层，拖慢应用启动。
- 在 `src/pages/order/detail.vue` 中写 `import x from '../../../utils/x'` 且层级不断增长。
- 未安装 `@dcloudio/types` 或未配置 `types`，导致 `uni` 与页面 API 类型丢失。
- `lang="ts"` 页面长期混用无类型组件链路，导致构建与类型检查不稳定。
- 页面与子组件分别使用不同导入风格，维护时频繁改路径。
- 在 `script` 中写 `import tool from '/common/tool.js'` 导致构建失败。
- 在 CLI 项目中误把 `@/` 当根目录外路径使用，导致 `json` 找不到。

## 检查项

- 新增文件是否符合目录职责。
- 文件命名是否与现有风格一致。
- 是否存在可抽离但未抽离的通用模块。
- 是否存在与 `Vite + TS` 结构冲突的历史目录或配置。
- `App.vue`、`pages.json`、`manifest.json` 的职责是否被混用。
- `export default` 外是否只保留必要的轻量代码。
- TS 依赖与 `tsconfig` 是否具备 `@dcloudio/types` 与 `resolveJsonModule` 等基础配置。
- `lang="ts"` 页面与组件链路是否保持一致并可通过类型检查。
- 导入路径是否优先使用 `@/` 或简洁可维护的相对路径。
- 页面与组件的导入路径规范是否一致。
- 是否存在以 `/` 开头的 `js` 模块导入语句。
- `json` 导入路径是否统一为相对路径或 `@/`，并与当前脚手架别名语义一致。

## 来源

- 官方教程（2026-02-11 查阅）：https://uniapp.dcloud.net.cn/tutorial/
- 官方教程（2026-02-11 查阅）：https://uniapp.dcloud.net.cn/tutorial/project.html
- 官方教程（2026-02-11 查阅）：https://uniapp.dcloud.net.cn/tutorial/page.html
- 官方教程（2026-02-11 查阅）：https://uniapp.dcloud.net.cn/tutorial/page-path.html
- 官方教程（2026-02-11 查阅）：https://uniapp.dcloud.net.cn/tutorial/page-component.html
- 官方教程（2026-02-11 查阅）：https://uniapp.dcloud.net.cn/tutorial/page-script.html
- 官方教程（2026-02-11 查阅）：https://uniapp.dcloud.net.cn/tutorial/page-json.html
- 官方教程（2026-02-11 查阅）：https://uniapp.dcloud.net.cn/tutorial/typescript-subject.html
